with saving_s as (select sum (amount) as s, s.date as d from dbo.saving s where userId = 8 and  s.date between '2021-01-01' and '2021-12-28'  group by s.date), transactions_s as ((select sum(amount) as t1, t.date as d from dbo.transactions t where userId = 8 and  type = 'income' and t.date between '2021-01-01' and '2021-12-28' group by t.date)) select case when t.d is null then s.d else t.d end as d from transactions_s t full outer join saving_s s on s.d = t.d where t.userId = 8 and  1=1