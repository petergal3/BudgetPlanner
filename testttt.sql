with saving_s as (select sum (amount) as s, s.date as d from dbo.saving s where userId = 8 and  s.date between '2021-01-01' and '2022-01-15' group by s.date), transactions_s as (select sum(amount) as t1, userId, t.date as d from dbo.transactions t where userId = 8 and  type = 'income' and t.date  between '2021-01-01' and '2022-01-15' group by t.date, userId) select case when s.d is null then 
(select s0.s from saving_s s0 where userId = 8 and  s0.d = (SELECT TOP 1 s1.d FROM saving_s s1 where userId = 8 and  s1.d < t.d and s1.d is not null  ORDER BY s1.d desc)) when (select s0.s from saving_s s0 where userId = 8 and  s0.d = (SELECT TOP 1 s1.d FROM saving_s s1 where userId = 8 and  s1.d < t.d and s1.d is not null  ORDER BY s1.d desc)) is null then 0 else s.s end as saving_amount from transactions_s t full outer join saving_s s on s.d = t.d 